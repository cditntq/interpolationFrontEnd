/*! xdnphb-html-rong QL 2017-05-13 17:05:19 */
"use strict";function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _get=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(window){var FunUtil={},PageInfo={};FunUtil.init=function(){String.HasText=function(a){return void 0!==a&&(null!=a&&("null"!=a&&("undefined"!=a&&("string"==typeof a&&(a=a.replace(/(^\s*)|(\s*$)/g,"")),""!==a))))}},FunUtil.init(),FunUtil.common4getUrlParam=function(){var a=location.href,b={};if(-1!=a.indexOf("?"))for(var c=a.split("?")[1],d=c.split("&"),e=0;e<d.length;e++)b[d[e].split("=")[0]]=unescape(d[e].split("=")[1]);return b},FunUtil.common4Prop=function(a){var b={};return b.isIN=function(){return a.in in a.obj},b[a.type]()},FunUtil.common4class=function(a){var b=a,c=function(){function a(b){_classCallCheck(this,a)}return _createClass(a,[{key:"data",value:function(){}},{key:"init",value:function(){console.log("init")}},{key:"update",value:function(){}},{key:"show",value:function(){console.log("show")}},{key:"hide",value:function(){console.log("hide")}},{key:"destory",value:function(){}}]),a}();return new(function(a){function c(a){return _classCallCheck(this,c),_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,a))}return _inherits(c,a),_createClass(c,[{key:"data",value:function(){if(_get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"data",this).call(this),FunUtil.common4Prop({type:"isIN",in:"data",obj:b}))return b.data()}},{key:"init",value:function(){_get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"init",this).call(this),FunUtil.common4Prop({type:"isIN",in:"init",obj:b})&&b.init()}},{key:"update",value:function(){_get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"update",this).call(this),FunUtil.common4Prop({type:"isIN",in:"update",obj:b})&&b.update()}},{key:"show",value:function(){if(_get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"show",this).call(this),FunUtil.common4Prop({type:"isIN",in:"show",obj:b})){var a=new function(){for(var a in FunUtil.Global.Page.require)this[a]=FunUtil.Global.Page.require[a]};b.show.call(a,"var")}}},{key:"hide",value:function(){_get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"hide",this).call(this),FunUtil.common4Prop({type:"isIN",in:"hide",obj:b})&&b.hide()}},{key:"destory",value:function(){_get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"destory",this).call(this),FunUtil.common4Prop({type:"isIN",in:"destory",obj:b})&&b.destory()}}]),c}(c))},FunUtil.common4openUrl=function(a){var b=a.url;if(String.HasText(b)){var c="until-open-url",d=$("#"+c);d.length<=0&&$("body").append('<a style="color: #f6f6f6;"><span id="'+c+'" >a</span></a>'),d=$("#"+c);var e=d.closest("a");if(FunUtil.Global.Router)e.attr("href","#/"+b).attr("target","_self");else{b=b.replace(/\//g,"-");var f=b.split("?");b=1==f.length?f[0]+".html":f[0]+".html?"+f[1],e.attr("href",b).attr("target","_self")}d.click(),setTimeout(function(){e.remove()},200)}},FunUtil.common4cache=function(a){var b={},c=a.key,d=a.value,e=a.model;return String.HasText(e)||(e=""),b.setItem=function(){"lo"==e?localStorage.setItem(c,d):sessionStorage.setItem(c,d)},b.getItem=function(){var a="";return a="lo"==e?localStorage.getItem(c):sessionStorage.getItem(c),String.HasText(a)&&(a=JSON.parse(a)),a},b[a.type+"Item"]()},FunUtil.Global={},FunUtil.common4Stack=function(a){var b={};b.pub=function(){},b.hash=function(){},b.history=function(){},b.page=function(){},b[a.type]()},FunUtil.common4hash=function(a){var b=a.key,c={};return c.encode=function(){return b.replace(/\#/g,"Qlive").replace(/\//g,"-")},c.decode=function(){return b.replace(/\Qlive/g,"#").replace(/-/g,"/")},c.js=function(){return c.decode().replace(/#/g,"")},c[a.type]()},FunUtil.common4Page=function(data){var fun4help={global:{type:"single"}};fun4help.single=function(){for(var a=FunUtil.Global.Page,b=a.require,c=Object.keys(b),d=Object.values(b),e=c.length,f=[],g=0;g<e;g++)f.push(FunUtil.common4require(d[g]));Promise.all(f).then(function(b){FunUtil.Global.Page.require={};for(var d=a,f=0;f<e;f++)FunUtil.Global.Page.require[c[f]]=b[f];d.init(),d.show()})},fun4help.model=function(){data.jid=data.jid.split("?")[0];var $main=$("#"+FunUtil.Global.id),Router=FunUtil.Global.Router;Router.unshift({});var id=data.jid,nid=Router.findIndex(function(a,b,c){if(a.jid==id)return b})-1,oid=Router.findIndex(function(a,b,c){if("show"==a.state)return b})-1;Router.shift();var Npage=Router[nid],type="noPre",execuFun={};execuFun.pub=function(data){var futil={},url="/"+FunUtil.common4hash({type:"js",key:id+""});futil.getJs=function(){Promise.resolve(FunUtil.common4require(url)).then(function(param){var require=param.require,keys=Object.keys(require),vals=Object.values(require),len=keys.length,list=[];eval("var "+keys.join(",")+";");for(var i=0;i<len;i++)list.push(FunUtil.common4require(vals[i]));Promise.all(list).then(function(a){for(var b=0;b<len;b++)FunUtil.Global.Page.require[keys[b]]=a[b];var c=param;FunUtil.Global.Router[nid].page=c,FunUtil.Global.Router[nid].state="show",$main.append('<div class="'+id+'">'+c.data().HtmUtil.layout()+"</div").show(),console.log(FunUtil.Global.Router[nid].jid),c.init(),c.show()})},function(a){})},futil.getJs()},execuFun.noPre=function(){String.HasText(Npage.page)?(Npage.page.show(),Npage.state="show",FunUtil.Global.Router[nid]=Npage,$main.find("div."+id).show()):execuFun.pub()},execuFun.hasPre=function(){var a=Router[oid];console.log(a.jid),a.page.hide(),a.state="hide",FunUtil.Global.Router[oid]=a,$main.find("div."+a.jid).hide(),String.HasText(Npage.page)?(console.log(Npage.jid),Npage.page.show(),Npage.state="show",FunUtil.Global.Router[nid]=Npage,$main.find("div."+Npage.jid).show()):execuFun.pub()},String.HasText(oid)&&oid>-1&&(type="hasPre"),execuFun[type]()},String.HasText(FunUtil.Global.Router)&&(fun4help.global.type="model"),fun4help[fun4help.global.type]()},FunUtil.register4Evet=function(a){var b={};b.pub=function(){},b.hash=function(){var a=function(){var a=FunUtil.common4hash({type:"decode",key:FunUtil.Global.Router[0].jid}),b=a,c=location.hash;if(String.HasText(location.hash)){var d=c.split("?")[0];d=d.substring(2);var e=FunUtil.Global.Jids[d];String.HasText(e)&&(b="#"+e)}FunUtil.common4Page({jid:FunUtil.common4hash({type:"encode",key:b})})};window.onhashchange=function(b){a()},String.HasText(FunUtil.Global.Router)&&a()},b.history=function(){},b[a.type]()},FunUtil.common4GetJS=function(data){var vnum="0000";try{vnum=v4num}catch(e){vnum="0000"}var request=function(a){var b=null;if(window.XMLHttpRequest?b=new XMLHttpRequest:window.ActiveXObject&&(b=new ActiveXObject("Microsoft.XMLHTTP")),null===b)return void alert("不支持咯");b.onreadystatechange=function(){4==b.readyState&&200==b.status&&(FunUtil.common4cache({type:"set",key:b.responseURL,value:JSON.stringify({vnum:vnum,js:b.responseText}),model:"lo"}),a())},b.open("GET",data.url,!0),b.send(null)},callback=function(){var a=document.createElement("script");a.type="text/javascript",a.src=data.url,String.HasText(data.async)?data.async:a.async="async",String.HasText(data.type)&&"head"==data.type?document.head.appendChild(a):document.body.appendChild(a),a.readyState?a.onreadystatechange=function(){"complete"!=a.readyState&&"loaded"!=a.readyState||(a.onreadystatechange=null,data.callback(),a.remove())}:a.onload=function(){data.callback(),a.remove()}};if(String.HasText(FunUtil.Global.Router)){var ljs=FunUtil.common4cache({type:"get",key:data.url,model:"lo"});if(String.HasText(ljs)&&data.url.indexOf("layui")<0&&ljs.vnum==vnum)return eval(ljs.js),void data.callback()}request(callback)},FunUtil.common4require=function(a){return new Promise(function(b){var c=FunUtil.Global.config().paths,d="foot",e=location.origin+"/"+location.pathname.split("/")[1]+a+".js",f={};FunUtil.common4Prop({type:"isIN",in:a,obj:c})&&(e=c[a],d="head");f.head=function(){FunUtil.common4GetJS({url:e,async:"async",callback:function(a){b(FunUtil.Global.plug)}})},f.foot=function(){FunUtil.common4GetJS({url:e,async:"async",callback:function(a){b(e.indexOf("common")>=0?FunUtil.Global.plug:FunUtil.Global.Page)}})},f[d]()})},FunUtil.common4Router=function(a){var b=a,c=b.flag,d=Object.keys(b.list),e=Object.values(b.list),f=d.length,g=[];if("hash"==c)for(var h=0;h<f;h++)g.push({id:FunUtil.common4hash({type:"encode",key:d[h]}),jid:FunUtil.common4hash({type:"encode",key:"#"+e[h]}),page:"",state:""});FunUtil.Global.Router=g,FunUtil.Global.Jids=b.list,FunUtil.register4Evet({type:c})},FunUtil.common4Global=function(a){FunUtil.Global.id=a.id,FunUtil.Global.name=a.name},PageInfo.init4plug=function(a){FunUtil.Global.plug=a.info},PageInfo.init4Obj=function(a){var b=a.info();FunUtil.Global.Page=FunUtil.common4class(b.page()),FunUtil.Global.Page.require=b.require,String.HasText(FunUtil.Global.Router)||FunUtil.common4Page()},PageInfo.init4Start=function(a){var b={};b.getJs=function(a){for(var b=a.require,c=Object.keys(b),d=Object.values(b),e=c.length,f=[],g=0;g<e;g++)f.push(FunUtil.common4require(d[g]));Promise.all(f).then(function(b){FunUtil.common4Global(a.Global),FunUtil.common4Router(a.Router);var d=new function(){for(var a=0;a<e;a++)this[c[a]]=b[a]};a.Pub.call(d,"var")})},b.getJs(a.info())},PageInfo.init4config=function(a){FunUtil.Global.config=a.info},PageInfo.register=function(a){PageInfo["init4"+a.type](a)},PageInfo.FunUtil=FunUtil,window.PageInfo=PageInfo}(window);